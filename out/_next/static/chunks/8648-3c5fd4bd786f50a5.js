"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8648],{62869:function(e,t,r){r.d(t,{d:function(){return l},z:function(){return u}});var n=r(57437),o=r(2265),a=r(37053),i=r(90535),s=r(94508);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md shadow-primary/15",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input/70 bg-background/70 backdrop-blur hover:bg-accent/70 hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent/70 hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"gradient-egyptian text-white hover:opacity-90 shadow-md transition-opacity"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=o.forwardRef((e,t)=>{let{className:r,variant:o,size:i,asChild:u=!1,...d}=e,c=u?a.g7:"button";return(0,n.jsx)(c,{className:(0,s.cn)(l({variant:o,size:i,className:r})),ref:t,...d})});u.displayName="Button"},66070:function(e,t,r){r.d(t,{Ol:function(){return s},SZ:function(){return u},Zb:function(){return i},aY:function(){return d},ll:function(){return l}});var n=r(57437),o=r(2265),a=r(94508);let i=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-3xl border border-border/60 bg-card/80 backdrop-blur-sm text-card-foreground shadow-sm hover:shadow-lg hover:-translate-y-0.5 transition-all duration-300",r),...o})});i.displayName="Card";let s=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...o})});s.displayName="CardHeader";let l=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...o})});l.displayName="CardTitle";let u=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...o})});u.displayName="CardDescription";let d=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...o})});d.displayName="CardContent",o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...o})}).displayName="CardFooter"},74208:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(57437),o=r(33145),a=r(2265),i=r(94508);function s(e){let{src:t,alt:r,fill:s=!1,className:l,width:u,height:d,priority:c=!1,fallbackSrc:f}=e,[g,h]=(0,a.useState)(t),[p,m]=(0,a.useState)(!1),v=()=>{if(f)return f;let e=r.toLowerCase();return e.includes("pyramid")||e.includes("giza")?"/images/pyramids-giza.svg":e.includes("luxor")?"/images/luxor-temple.svg":e.includes("red sea")||e.includes("resort")?"/images/red-sea-resort.svg":"https://placehold.co/600x400"};return(0,n.jsxs)("div",{className:(0,i.cn)("relative overflow-hidden",l),children:[(0,n.jsx)(o.default,{src:g,alt:r,fill:s,width:s?void 0:u,height:s?void 0:d,priority:c,className:(0,i.cn)("object-cover transition-all duration-300",p&&"opacity-90"),onError:()=>{p||(m(!0),h(v()))},unoptimized:!0}),p&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,n.jsx)("div",{className:"text-center text-gray-500 bg-white/80 px-2 py-1 rounded",children:(0,n.jsx)("span",{className:"text-xs",children:"Fallback Image"})})})]})}},94508:function(e,t,r){r.d(t,{cn:function(){return a}});var n=r(61994),o=r(53335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}},72218:function(e,t,r){r.d(t,{Cd:function(){return u},Dj:function(){return d},K4:function(){return i},av:function(){return f},sT:function(){return s},vJ:function(){return c}});var n=r(39129);let o={user:(e=>{try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return null}})("user"),token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken"),isAuthenticated:!!localStorage.getItem("token"),isLoading:!1,error:null},a=(0,n.oM)({name:"auth",initialState:o,reducers:{setLoading:(e,t)=>{e.isLoading=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null},logout:e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1,e.error=null,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("tokenExpiry"),localStorage.removeItem("user")},tokenRefreshed:(e,t)=>{let{token:r,refreshToken:n,expiresIn:o}=t.payload;if(e.token=r,e.refreshToken=n,e.isAuthenticated=!0,localStorage.setItem("token",r),localStorage.setItem("refreshToken",n),o){let e=Date.now()+1e3*o;localStorage.setItem("tokenExpiry",e.toString())}},setCredentials:(e,t)=>{let{user:r,token:n,refreshToken:o,expiresIn:a}=t.payload;if(e.user=r,e.token=n,e.refreshToken=o,e.isAuthenticated=!0,e.error=null,e.isLoading=!1,localStorage.setItem("token",n),localStorage.setItem("refreshToken",o),localStorage.setItem("user",JSON.stringify(r)),a){let e=Date.now()+1e3*a;localStorage.setItem("tokenExpiry",e.toString())}},setUser:(e,t)=>{e.user=t.payload,e.isAuthenticated=!0,localStorage.setItem("user",JSON.stringify(t.payload))}}}),{setLoading:i,setError:s,clearError:l,logout:u,setCredentials:d,tokenRefreshed:c,setUser:f}=a.actions;t.ZP=a.reducer},38059:function(e,t,r){r.d(t,{h:function(){return g}});var n=r(79523),o=r(23557),a=r(72218);let i=e=>{try{return window.localStorage.getItem(e)}catch(e){return null}},s=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){}},l=e=>{try{window.localStorage.removeItem(e)}catch(e){}},u=()=>{let e=i("tokenExpiry");return!e||Date.now()>=parseInt(e,10)},d=()=>{let e=i("tokenExpiry");if(!e)return!1;let t=Date.now();return parseInt(e,10)-t<3e5},c=(0,n.ni)({baseUrl:"https://kemeteg.runasp.net/api",prepareHeaders:(e,t)=>{var r,n;let{getState:o}=t,a=(null===(n=o())||void 0===n?void 0:null===(r=n.auth)||void 0===r?void 0:r.token)||i("token");return a&&e.set("authorization","Bearer ".concat(a)),e.set("content-type","application/json"),e}}),f=async(e,t,r)=>{if(d()){console.log("Token expiring soon, refreshing proactively...");let e=i("refreshToken");if(e){let n=await c({url:"/Auth/refresh",method:"POST",body:{refreshToken:e}},t,r);if(n.data){let r=n.data,o=(null==r?void 0:r.data)||r,i=null==o?void 0:o.accessToken,l=null==o?void 0:o.refreshToken,u=(null==o?void 0:o.expiresIn)||3600;i&&(s("token",i),l&&s("refreshToken",l),s("tokenExpiry",(Date.now()+1e3*u).toString()),t.dispatch((0,a.vJ)({token:i,refreshToken:l||e,expiresIn:u})),console.log("Token refreshed successfully"))}}}let n=await c(e,t,r);if(n.error&&401===n.error.status){console.log("Unauthorized (401), attempting to refresh token...");let o=i("refreshToken");if(o&&!u()){let i=await c({url:"/Auth/refresh",method:"POST",body:{refreshToken:o}},t,r);if(i.data){let l=i.data,u=(null==l?void 0:l.data)||l,d=null==u?void 0:u.accessToken,f=null==u?void 0:u.refreshToken,g=(null==u?void 0:u.expiresIn)||3600;d&&(s("token",d),f&&s("refreshToken",f),s("tokenExpiry",(Date.now()+1e3*g).toString()),t.dispatch((0,a.vJ)({token:d,refreshToken:f||o,expiresIn:g})),n=await c(e,t,r),console.log("Token refreshed and request retried"))}else console.log("Token refresh failed, logging out..."),l("token"),l("refreshToken"),l("tokenExpiry"),t.dispatch((0,a.Cd)()),window.location.href="/login"}else console.log("No valid refresh token, logging out..."),l("token"),l("refreshToken"),l("tokenExpiry"),t.dispatch((0,a.Cd)()),window.location.href="/login"}return n},g=(0,o.LC)({reducerPath:"api",baseQuery:f,tagTypes:["User","Auth","TravelPlan","Destination","Analytics","Booking","Review","Preference","Notification"],endpoints:()=>({})})},37775:function(e,t,r){r.d(t,{Fm:function(){return s},R5:function(){return n},aZ:function(){return i},t$:function(){return o},y0:function(){return a}});let{useGetDestinationsQuery:n,useGetDestinationQuery:o,useCreateDestinationMutation:a,useUpdateDestinationMutation:i,useDeleteDestinationMutation:s}=r(38059).h.injectEndpoints({endpoints:e=>({getDestinations:e.query({query:()=>"/Destinations",providesTags:["Destination"]}),getDestination:e.query({query:e=>"/Destinations/".concat(e),providesTags:(e,t,r)=>[{type:"Destination",id:r}]}),createDestination:e.mutation({query:e=>({url:"/Destinations",method:"POST",body:e}),invalidatesTags:["Destination"]}),updateDestination:e.mutation({query:e=>{let{id:t,data:r}=e;return{url:"/Destinations/".concat(t),method:"PUT",body:r}},invalidatesTags:(e,t,r)=>{let{id:n}=r;return[{type:"Destination",id:n},"Destination"]}}),deleteDestination:e.mutation({query:e=>({url:"/Destinations/".concat(e),method:"DELETE"}),invalidatesTags:["Destination"]})})})}}]);