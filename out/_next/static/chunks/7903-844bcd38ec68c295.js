"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7903],{24114:function(e,t,r){r.d(t,{qE:function(){return N},Q5:function(){return b}});var n=r(57437),o=r(2265),u=r(73966),a=r(26606),i=r(61188),l=r(66840),s=r(82558);function c(){return()=>{}}var f="Avatar",[d,m]=(0,u.b)(f),[v,p]=d(f),h=o.forwardRef((e,t)=>{let{__scopeAvatar:r,...u}=e,[a,i]=o.useState("idle");return(0,n.jsx)(v,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:(0,n.jsx)(l.WV.span,{...u,ref:t})})});h.displayName=f;var g="AvatarImage",w=o.forwardRef((e,t)=>{let{__scopeAvatar:r,src:u,onLoadingStatusChange:f=()=>{},...d}=e,m=p(g,r),v=function(e,t){let{referrerPolicy:r,crossOrigin:n}=t,u=(0,s.useSyncExternalStore)(c,()=>!0,()=>!1),a=o.useRef(null),l=u?(a.current||(a.current=new window.Image),a.current):null,[f,d]=o.useState(()=>x(l,e));return(0,i.b)(()=>{d(x(l,e))},[l,e]),(0,i.b)(()=>{let e=e=>()=>{d(e)};if(!l)return;let t=e("loaded"),o=e("error");return l.addEventListener("load",t),l.addEventListener("error",o),r&&(l.referrerPolicy=r),"string"==typeof n&&(l.crossOrigin=n),()=>{l.removeEventListener("load",t),l.removeEventListener("error",o)}},[l,n,r]),f}(u,d),h=(0,a.W)(e=>{f(e),m.onImageLoadingStatusChange(e)});return(0,i.b)(()=>{"idle"!==v&&h(v)},[v,h]),"loaded"===v?(0,n.jsx)(l.WV.img,{...d,ref:t,src:u}):null});w.displayName=g;var y="AvatarFallback",S=o.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:u,...a}=e,i=p(y,r),[s,c]=o.useState(void 0===u);return o.useEffect(()=>{if(void 0!==u){let e=window.setTimeout(()=>c(!0),u);return()=>window.clearTimeout(e)}},[u]),s&&"loaded"!==i.imageLoadingStatus?(0,n.jsx)(l.WV.span,{...a,ref:t}):null});function x(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}S.displayName=y;var E=r(94508);let N=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(h,{ref:t,className:(0,E.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...o})});N.displayName=h.displayName,o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(w,{ref:t,className:(0,E.cn)("aspect-square h-full w-full",r),...o})}).displayName=w.displayName;let b=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,n.jsx)(S,{ref:t,className:(0,E.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...o})});b.displayName=S.displayName},30406:function(e,t,r){r.d(t,{AuthProvider:function(){return f},a:function(){return d}});var n=r(57437),o=r(2265),u=r(68575);let a=()=>(0,u.I0)(),i=u.v9;var l=r(46102),s=r(72218);let c=(0,o.createContext)(void 0);function f(e){var t,r;let{children:u}=e,f=i(e=>e.auth),d=a(),[m]=(0,l.YA)(),[v]=(0,l._y)(),[p]=(0,l.ru)();(0,o.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("refreshToken");!e&&t&&p({refreshToken:t}).catch(()=>{})},[p]),(0,o.useEffect)(()=>{let e=async()=>{let e=localStorage.getItem("tokenExpiry"),t=localStorage.getItem("refreshToken");if(!e||!t)return;let r=parseInt(e,10);if(Date.now()>=r-12e4){console.log("Token expiring soon or expired, attempting refresh...");try{await p({refreshToken:t}).unwrap(),console.log("Periodic refresh successful")}catch(e){console.log("Periodic refresh failed, session truly expired"),g()}}};e();let t=setInterval(e,6e4);return()=>clearInterval(t)},[p]);let h=async(e,t)=>{try{return await m({email:e,password:t}).unwrap(),!0}catch(e){return!1}},g=async()=>{d((0,s.Cd)()),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("tokenExpiry"),localStorage.removeItem("user");try{let e=f.refreshToken||localStorage.getItem("refreshToken");e&&await v({refreshToken:e}).unwrap()}catch(e){}window.location.href="/login"},w={user:f.user,login:h,logout:g,isAuthenticated:f.isAuthenticated,isAdmin:(null===(t=f.user)||void 0===t?void 0:t.role)==="admin",isTourist:(null===(r=f.user)||void 0===r?void 0:r.role)==="tourist"};return(0,n.jsx)(c.Provider,{value:w,children:u})}function d(){let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},47692:function(e,t,r){r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},99376:function(e,t,r){var n=r(35475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},24369:function(e,t,r){var n=r(2265),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},u=n.useState,a=n.useEffect,i=n.useLayoutEffect,l=n.useDebugValue;function s(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!o(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=u({inst:{value:r,getSnapshot:t}}),o=n[0].inst,c=n[1];return i(function(){o.value=r,o.getSnapshot=t,s(o)&&c({inst:o})},[e,r,t]),a(function(){return s(o)&&c({inst:o}),e(function(){s(o)&&c({inst:o})})},[e]),l(r),r};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:c},82558:function(e,t,r){e.exports=r(24369)},73966:function(e,t,r){r.d(t,{b:function(){return u}});var n=r(2265),o=r(57437);function u(e,t=[]){let r=[],u=()=>{let t=r.map(e=>n.createContext(e));return function(r){let o=r?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...r,[e]:o}}),[r,o])}};return u.scopeName=e,[function(t,u){let a=n.createContext(u);a.displayName=t+"Context";let i=r.length;r=[...r,u];let l=t=>{let{scope:r,children:u,...l}=t,s=r?.[e]?.[i]||a,c=n.useMemo(()=>l,Object.values(l));return(0,o.jsx)(s.Provider,{value:c,children:u})};return l.displayName=t+"Provider",[l,function(r,o){let l=o?.[e]?.[i]||a,s=n.useContext(l);if(s)return s;if(void 0!==u)return u;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let o=r.reduce((t,{useScope:r,scopeName:n})=>{let o=r(e)[`__scope${n}`];return{...t,...o}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}(u,...t)]}},66840:function(e,t,r){r.d(t,{WV:function(){return a}});var n=r(2265);r(54887);var o=r(37053),u=r(57437),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,o.Z8)(`Primitive.${t}`),a=n.forwardRef((e,n)=>{let{asChild:o,...a}=e,i=o?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,u.jsx)(i,{...a,ref:n})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{})},26606:function(e,t,r){r.d(t,{W:function(){return o}});var n=r(2265);function o(e){let t=n.useRef(e);return n.useEffect(()=>{t.current=e}),n.useMemo(()=>(...e)=>t.current?.(...e),[])}},61188:function(e,t,r){r.d(t,{b:function(){return o}});var n=r(2265),o=globalThis?.document?n.useLayoutEffect:()=>{}},52345:function(e,t,r){r.d(t,{J:function(){return a}});var n=r(2265),o=r(75957),u=r(14004);function a(){u.O.current||(0,o.A)();let[e]=(0,n.useState)(u.n.current);return e}}}]);