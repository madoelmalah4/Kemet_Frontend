(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1595],{41525:function(e,t,r){Promise.resolve().then(r.bind(r,86258))},86258:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var n=r(57437),a=r(79405),o=r(27648),s=r(33145),i=r(88997),l=r(15863),c=r(83774),d=r(95252),u=r(76858),f=r(62869),h=r(66070),m=r(37775),g=r(37610),x=r(72218),p=r(77992);function y(){let{toast:e}=(0,p.pm)(),t=(0,g.CG)(x.vN),{data:r=[],isLoading:y,error:v}=(0,m.X_)(void 0,{skip:!t}),[b]=(0,m.XB)(),k=async(t,r)=>{t.preventDefault(),t.stopPropagation();try{await b(r).unwrap(),e({title:"Removed from favorites"})}catch(t){e({title:"Error",description:"Failed to remove from favorites.",variant:"destructive"})}};return t?y?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsx)(l.Z,{className:"h-12 w-12 animate-spin text-blue-600"})}):v?(0,n.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 flex-col gap-4",children:[(0,n.jsx)("p",{className:"text-red-500 font-semibold text-lg",children:"Failed to load favorites."}),(0,n.jsx)(f.z,{onClick:()=>window.location.reload(),children:"Try Again"})]}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50/50 py-12",children:(0,n.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-12",children:[(0,n.jsxs)(a.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[(0,n.jsx)("h1",{className:"font-display text-4xl font-bold text-gray-900 mb-2",children:"My Favorites"}),(0,n.jsx)("p",{className:"text-gray-600",children:"All the places you've saved for your adventure"})]}),(0,n.jsx)(o.default,{href:"/destinations",children:(0,n.jsx)(f.z,{variant:"outline",className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:"Explore More"})})]}),r.length>0?(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((e,t)=>(0,n.jsx)(a.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05*t},children:(0,n.jsx)(o.default,{href:"/destinations/detail?id=".concat(e.id),className:"block h-full group",children:(0,n.jsxs)(h.Zb,{className:"h-full overflow-hidden border-none shadow-md hover:shadow-xl transition-all duration-300 relative group bg-white",children:[(0,n.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden bg-gray-100",children:[e.imageUrl?(0,n.jsx)(s.default,{src:e.imageUrl,alt:e.name||"Destination",fill:!0,className:"object-cover transition-transform duration-500 group-hover:scale-110"}):(0,n.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No Image"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-60"}),(0,n.jsxs)("div",{className:"absolute top-3 left-3 right-3 flex justify-between items-start z-10",children:[(0,n.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm px-2.5 py-1 rounded-full text-xs font-medium text-gray-700 flex items-center gap-1",children:[(0,n.jsx)(c.Z,{className:"h-3 w-3"}),e.city]}),(0,n.jsx)(f.z,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors shadow-lg",onClick:t=>k(t,e.id),children:(0,n.jsx)(i.Z,{className:"w-4 h-4 fill-current"})})]}),void 0!==e.estimatedPrice&&(0,n.jsx)("div",{className:"absolute bottom-3 left-3 z-10",children:(0,n.jsxs)("div",{className:"bg-blue-600/90 backdrop-blur-sm px-2.5 py-1 rounded-lg text-xs font-bold text-white flex items-center gap-1",children:[(0,n.jsx)(d.Z,{className:"h-3 w-3"}),0===e.estimatedPrice?"Free":"".concat(e.estimatedPrice," EGP")]})})]}),(0,n.jsxs)(h.aY,{className:"p-5",children:[(0,n.jsx)("h3",{className:"font-display text-xl font-bold text-gray-900 mb-2 line-clamp-1 group-hover:text-blue-600 transition-colors",children:e.name}),(0,n.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4 leading-relaxed",children:e.description}),(0,n.jsxs)("div",{className:"flex items-center text-blue-600 text-sm font-semibold group-hover:gap-2 transition-all",children:["View Details",(0,n.jsx)(u.Z,{className:"ml-1 w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]})]})})},e.id))}):(0,n.jsx)(a.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:(0,n.jsx)(h.Zb,{className:"border-2 border-dashed border-gray-200 bg-white",children:(0,n.jsxs)(h.aY,{className:"py-20 text-center flex flex-col items-center",children:[(0,n.jsx)("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mb-6",children:(0,n.jsx)(i.Z,{className:"w-10 h-10 text-gray-300"})}),(0,n.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No favorites yet"}),(0,n.jsx)("p",{className:"text-gray-500 max-w-xs mb-8",children:"Browse destinations and click the heart icon to save them here."}),(0,n.jsx)(o.default,{href:"/destinations",children:(0,n.jsx)(f.z,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 rounded-xl h-12 shadow-lg hover:shadow-xl transition-all",children:"Browse Destinations"})})]})})})]})}):(0,n.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 flex-col gap-6 px-4 text-center",children:[(0,n.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center text-red-600",children:(0,n.jsx)(i.Z,{className:"w-10 h-10"})}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Login Required"}),(0,n.jsx)("p",{className:"text-gray-600 max-w-sm",children:"Please login to view your favorite destinations."}),(0,n.jsx)(o.default,{href:"/auth/login",children:(0,n.jsx)(f.z,{size:"lg",className:"bg-blue-600 hover:bg-blue-700",children:"Login Now"})})]})}},62869:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return c}});var n=r(57437),a=r(2265),o=r(37053),s=r(90535),i=r(94508);let l=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md shadow-primary/15",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input/70 bg-background/70 backdrop-blur hover:bg-accent/70 hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent/70 hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"gradient-egyptian text-white hover:opacity-90 shadow-md transition-opacity"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:s,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,n.jsx)(u,{className:(0,i.cn)(l({variant:a,size:s,className:r})),ref:t,...d})});c.displayName="Button"},66070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return s},aY:function(){return d},ll:function(){return l}});var n=r(57437),a=r(2265),o=r(94508);let s=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("rounded-3xl border border-border/60 bg-card/80 backdrop-blur-sm text-card-foreground shadow-sm hover:shadow-lg hover:-translate-y-0.5 transition-all duration-300",r),...a})});s.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},77992:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var n=r(2265);let a=0,o=new Map,s=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?s(r):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=i(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(c);return n.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},94508:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var n=r(61994),a=r(53335);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,n.W)(t))}},76858:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},95252:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},88997:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},15863:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},83774:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(39763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},72218:function(e,t,r){"use strict";r.d(t,{Cd:function(){return c},Dj:function(){return d},K4:function(){return s},av:function(){return f},sT:function(){return i},vJ:function(){return u},vN:function(){return h}});var n=r(39129);let a={user:(e=>{try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return null}})("user"),token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken"),isAuthenticated:!!localStorage.getItem("token"),isLoading:!1,error:null},o=(0,n.oM)({name:"auth",initialState:a,reducers:{setLoading:(e,t)=>{e.isLoading=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null},logout:e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1,e.error=null,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("tokenExpiry"),localStorage.removeItem("user")},tokenRefreshed:(e,t)=>{let{token:r,refreshToken:n,expiresIn:a}=t.payload;if(e.token=r,e.refreshToken=n,e.isAuthenticated=!0,localStorage.setItem("token",r),localStorage.setItem("refreshToken",n),a){let e=Date.now()+1e3*a;localStorage.setItem("tokenExpiry",e.toString())}},setCredentials:(e,t)=>{let{user:r,token:n,refreshToken:a,expiresIn:o}=t.payload;if(e.user=r,e.token=n,e.refreshToken=a,e.isAuthenticated=!0,e.error=null,e.isLoading=!1,localStorage.setItem("token",n),localStorage.setItem("refreshToken",a),localStorage.setItem("user",JSON.stringify(r)),o){let e=Date.now()+1e3*o;localStorage.setItem("tokenExpiry",e.toString())}},setUser:(e,t)=>{e.user=t.payload,e.isAuthenticated=!0,localStorage.setItem("user",JSON.stringify(t.payload))}}}),{setLoading:s,setError:i,clearError:l,logout:c,setCredentials:d,tokenRefreshed:u,setUser:f}=o.actions;t.ZP=o.reducer;let h=e=>e.auth.isAuthenticated},38059:function(e,t,r){"use strict";r.d(t,{h:function(){return h}});var n=r(79523),a=r(23557),o=r(72218);let s=e=>{try{return window.localStorage.getItem(e)}catch(e){return null}},i=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){}},l=e=>{try{window.localStorage.removeItem(e)}catch(e){}},c=()=>{let e=s("tokenExpiry");return!e||Date.now()>=parseInt(e,10)},d=()=>{let e=s("tokenExpiry");if(!e)return!1;let t=Date.now();return parseInt(e,10)-t<3e5},u=(0,n.ni)({baseUrl:"https://kemeteg.runasp.net/api",prepareHeaders:(e,t)=>{var r,n;let{getState:a}=t,o=(null===(n=a())||void 0===n?void 0:null===(r=n.auth)||void 0===r?void 0:r.token)||s("token");return o&&e.set("authorization","Bearer ".concat(o)),e.set("content-type","application/json"),e}}),f=async(e,t,r)=>{if(d()){console.log("Token expiring soon, refreshing proactively...");let e=s("refreshToken");if(e){let n=await u({url:"/Auth/refresh",method:"POST",body:{refreshToken:e}},t,r);if(n.data){let r=n.data,a=(null==r?void 0:r.data)||r,s=null==a?void 0:a.accessToken,l=null==a?void 0:a.refreshToken,c=(null==a?void 0:a.expiresIn)||3600;s&&(i("token",s),l&&i("refreshToken",l),i("tokenExpiry",(Date.now()+1e3*c).toString()),t.dispatch((0,o.vJ)({token:s,refreshToken:l||e,expiresIn:c})),console.log("Token refreshed successfully"))}}}let n=await u(e,t,r);if(n.error&&401===n.error.status){console.log("Unauthorized (401), attempting to refresh token...");let a=s("refreshToken");if(a&&!c()){let s=await u({url:"/Auth/refresh",method:"POST",body:{refreshToken:a}},t,r);if(s.data){let l=s.data,c=(null==l?void 0:l.data)||l,d=null==c?void 0:c.accessToken,f=null==c?void 0:c.refreshToken,h=(null==c?void 0:c.expiresIn)||3600;d&&(i("token",d),f&&i("refreshToken",f),i("tokenExpiry",(Date.now()+1e3*h).toString()),t.dispatch((0,o.vJ)({token:d,refreshToken:f||a,expiresIn:h})),n=await u(e,t,r),console.log("Token refreshed and request retried"))}else console.log("Token refresh failed, logging out..."),l("token"),l("refreshToken"),l("tokenExpiry"),t.dispatch((0,o.Cd)()),window.location.href="/login"}else console.log("No valid refresh token, logging out..."),l("token"),l("refreshToken"),l("tokenExpiry"),t.dispatch((0,o.Cd)()),window.location.href="/login"}return n},h=(0,a.LC)({reducerPath:"api",baseQuery:f,tagTypes:["User","Auth","TravelPlan","Destination","Analytics","Booking","Review","Preference","Notification","Favorites"],endpoints:()=>({})})},37775:function(e,t,r){"use strict";r.d(t,{Fm:function(){return i},R5:function(){return n},XB:function(){return c},X_:function(){return d},aZ:function(){return s},t$:function(){return a},ul:function(){return l},y0:function(){return o}});let{useGetDestinationsQuery:n,useGetDestinationQuery:a,useCreateDestinationMutation:o,useUpdateDestinationMutation:s,useDeleteDestinationMutation:i,useAddFavoriteMutation:l,useRemoveFavoriteMutation:c,useGetFavoritesQuery:d}=r(38059).h.injectEndpoints({endpoints:e=>({getDestinations:e.query({query:()=>"/Destinations",providesTags:["Destination"]}),getDestination:e.query({query:e=>"/Destinations/".concat(e),providesTags:(e,t,r)=>[{type:"Destination",id:r}]}),createDestination:e.mutation({query:e=>({url:"/Destinations",method:"POST",body:e}),invalidatesTags:["Destination"]}),updateDestination:e.mutation({query:e=>{let{id:t,data:r}=e;return{url:"/Destinations/".concat(t),method:"PUT",body:r}},invalidatesTags:(e,t,r)=>{let{id:n}=r;return[{type:"Destination",id:n},"Destination"]}}),deleteDestination:e.mutation({query:e=>({url:"/Destinations/".concat(e),method:"DELETE"}),invalidatesTags:["Destination"]}),addFavorite:e.mutation({query:e=>({url:"/Destinations/".concat(e,"/favorite"),method:"POST"}),invalidatesTags:(e,t,r)=>[{type:"Destination",id:r},"Favorites"]}),removeFavorite:e.mutation({query:e=>({url:"/Destinations/".concat(e,"/favorite"),method:"DELETE"}),invalidatesTags:(e,t,r)=>[{type:"Destination",id:r},"Favorites"]}),getFavorites:e.query({query:()=>"/Destinations/favorites",providesTags:["Favorites"]})})})},37610:function(e,t,r){"use strict";r.d(t,{CG:function(){return o},TL:function(){return a}});var n=r(68575);let a=()=>(0,n.I0)(),o=n.v9}},function(e){e.O(0,[6137,7210,5650,3557,3145,2971,2117,1744],function(){return e(e.s=41525)}),_N_E=e.O()}]);