(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{26259:function(e,t,r){Promise.resolve().then(r.bind(r,47354))},47354:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return q}});var a=r(57437),s=r(2265),n=r(27648),l=r(33145),i=r(79405),o=r(15863),d=r(99397),c=r(83774),u=r(53113),f=r(29374),m=r(73247),x=r(42208),h=r(15868),g=r(18930),p=r(37775),y=r(62869),v=r(95186),b=r(66070),j=r(94508);let N=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,j.cn)("w-full caption-bottom text-sm",r),...s})})});N.displayName="Table";let w=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,j.cn)("[&_tr]:border-b",r),...s})});w.displayName="TableHeader";let k=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,j.cn)("[&_tr:last-child]:border-0",r),...s})});k.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,j.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let T=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,j.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});T.displayName="TableRow";let S=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,j.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});S.displayName="TableHead";let D=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,j.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});D.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,j.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption";var I=r(35974),R=r(77992),E=r(91251);let C=E.fC,A=E.xz,O=E.h_,Z=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(E.aV,{className:(0,j.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s,ref:t})});Z.displayName=E.aV.displayName;let _=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsxs)(O,{children:[(0,a.jsx)(Z,{}),(0,a.jsx)(E.VY,{ref:t,className:(0,j.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...s})]})});_.displayName=E.VY.displayName;let z=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,j.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};z.displayName="AlertDialogHeader";let U=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,j.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};U.displayName="AlertDialogFooter";let P=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(E.Dx,{ref:t,className:(0,j.cn)("text-lg font-semibold",r),...s})});P.displayName=E.Dx.displayName;let L=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(E.dk,{ref:t,className:(0,j.cn)("text-sm text-muted-foreground",r),...s})});L.displayName=E.dk.displayName;let M=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(E.aU,{ref:t,className:(0,j.cn)((0,y.d)(),r),...s})});M.displayName=E.aU.displayName;let V=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(E.$j,{ref:t,className:(0,j.cn)((0,y.d)({variant:"outline"}),"mt-2 sm:mt-0",r),...s})});function q(){let{toast:e}=(0,R.pm)(),[t,r]=(0,s.useState)(""),{data:j=[],isLoading:E,error:O}=(0,p.R5)(),[Z,{isLoading:q}]=(0,p.Fm)(),F=j.filter(e=>{var r;return e.name.toLowerCase().includes(t.toLowerCase())||(null===(r=e.city)||void 0===r?void 0:r.toLowerCase().includes(t.toLowerCase()))}),Y=(0,s.useMemo)(()=>{let e=new Set(j.map(e=>e.city)).size,t=j.filter(e=>e.imageUrl).length,r=j.filter(e=>e.vrUrlImage).length;return{total:j.length,cities:e,withImages:t,withVR:r}},[j]),J=async t=>{try{await Z(t).unwrap(),e({title:"Success",description:"Destination deleted successfully"})}catch(t){e({title:"Error",description:"Failed to delete destination",variant:"destructive"})}};return E?(0,a.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,a.jsx)(o.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):O?(0,a.jsx)("div",{className:"p-8 text-red-500",children:"Error loading destinations. Please try again."}):(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-display font-bold text-gray-900",children:"Destinations"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage all travel destinations"})]}),(0,a.jsx)(n.default,{href:"/admin/destinations/create",children:(0,a.jsxs)(y.z,{className:"bg-blue-600 hover:bg-blue-700 text-white shadow-sm",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Add Destination"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(b.Zb,{className:"border-gray-200",children:(0,a.jsx)(b.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Destinations"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Y.total})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"h-6 w-6 text-blue-600"})})]})})}),(0,a.jsx)(b.Zb,{className:"border-gray-200",children:(0,a.jsx)(b.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Cities"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Y.cities})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"h-6 w-6 text-orange-600"})})]})})}),(0,a.jsx)(b.Zb,{className:"border-gray-200",children:(0,a.jsx)(b.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"With Images"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Y.withImages})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"h-6 w-6 text-green-600"})})]})})}),(0,a.jsx)(b.Zb,{className:"border-gray-200",children:(0,a.jsx)(b.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"With VR Tours"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Y.withVR})]}),(0,a.jsx)("div",{className:"h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(f.Z,{className:"h-6 w-6 text-purple-600"})})]})})})]}),(0,a.jsxs)(b.Zb,{className:"border-gray-200",children:[(0,a.jsx)(b.Ol,{className:"border-b border-gray-200 bg-gray-50/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(b.ll,{className:"text-lg font-semibold",children:"All Destinations"}),(0,a.jsxs)("div",{className:"relative w-full max-w-sm",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)(v.I,{placeholder:"Search destinations...",value:t,onChange:e=>r(e.target.value),className:"pl-9 h-9 bg-white"})]})]})}),(0,a.jsx)(b.aY,{className:"p-0",children:(0,a.jsxs)(N,{children:[(0,a.jsx)(w,{children:(0,a.jsxs)(T,{className:"bg-gray-50/50",children:[(0,a.jsx)(S,{className:"w-[80px]",children:"Image"}),(0,a.jsx)(S,{children:"Name"}),(0,a.jsx)(S,{children:"City"}),(0,a.jsx)(S,{className:"w-[120px]",children:"Features"}),(0,a.jsx)(S,{className:"text-right w-[140px]",children:"Actions"})]})}),(0,a.jsx)(k,{children:0===F.length?(0,a.jsx)(T,{children:(0,a.jsx)(D,{colSpan:5,className:"h-32 text-center text-gray-500",children:"No destinations found."})}):F.map(e=>(0,a.jsxs)(T,{className:"hover:bg-gray-50/50",children:[(0,a.jsx)(D,{children:(0,a.jsx)("div",{className:"relative w-14 h-14 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:e.imageUrl?(0,a.jsx)(l.default,{src:e.imageUrl,alt:e.name,fill:!0,className:"object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-gray-400"})})})}),(0,a.jsxs)(D,{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500 line-clamp-1 mt-0.5",children:e.description})]}),(0,a.jsx)(D,{children:(0,a.jsxs)("div",{className:"flex items-center text-gray-700",children:[(0,a.jsx)(c.Z,{className:"w-3.5 h-3.5 mr-1.5 text-gray-400"}),e.city]})}),(0,a.jsx)(D,{children:(0,a.jsxs)("div",{className:"flex gap-1.5",children:[e.imageUrl&&(0,a.jsxs)(I.C,{variant:"secondary",className:"text-xs bg-green-100 text-green-700 hover:bg-green-100",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1"}),"Image"]}),e.vrUrlImage&&(0,a.jsxs)(I.C,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700 hover:bg-purple-100",children:[(0,a.jsx)(f.Z,{className:"w-3 h-3 mr-1"}),"VR"]})]})}),(0,a.jsx)(D,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,a.jsx)(n.default,{href:"/destinations/".concat(e.id),target:"_blank",children:(0,a.jsx)(y.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-600 hover:text-blue-600 hover:bg-blue-50",children:(0,a.jsx)(x.Z,{className:"w-4 h-4"})})}),(0,a.jsx)(n.default,{href:"/admin/destinations/edit/".concat(e.id),children:(0,a.jsx)(y.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-600 hover:text-orange-600 hover:bg-orange-50",children:(0,a.jsx)(h.Z,{className:"w-4 h-4"})})}),(0,a.jsxs)(C,{children:[(0,a.jsx)(A,{asChild:!0,children:(0,a.jsx)(y.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-600 hover:text-red-600 hover:bg-red-50",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})})}),(0,a.jsxs)(_,{children:[(0,a.jsxs)(z,{children:[(0,a.jsx)(P,{children:"Delete Destination?"}),(0,a.jsxs)(L,{children:['This will permanently delete "',e.name,'". This action cannot be undone.']})]}),(0,a.jsxs)(U,{children:[(0,a.jsx)(V,{children:"Cancel"}),(0,a.jsx)(M,{onClick:()=>J(e.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})})]},e.id))})]})})]})]})}V.displayName=E.$j.displayName},35974:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var a=r(57437),s=r(2265),n=r(94508);let l=s.forwardRef((e,t)=>{let{className:r,variant:s="default",...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border border-input"}[s],r),...l})});l.displayName="Badge"},62869:function(e,t,r){"use strict";r.d(t,{d:function(){return o},z:function(){return d}});var a=r(57437),s=r(2265),n=r(37053),l=r(90535),i=r(94508);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md shadow-primary/15",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input/70 bg-background/70 backdrop-blur hover:bg-accent/70 hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent/70 hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"gradient-egyptian text-white hover:opacity-90 shadow-md transition-opacity"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-lg px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(o({variant:s,size:l,className:r})),ref:t,...c})});d.displayName="Button"},66070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return c},ll:function(){return o}});var a=r(57437),s=r(2265),n=r(94508);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-3xl border border-border/60 bg-card/80 backdrop-blur-sm text-card-foreground shadow-sm hover:shadow-lg hover:-translate-y-0.5 transition-all duration-300",r),...s})});l.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},95186:function(e,t,r){"use strict";r.d(t,{I:function(){return l}});var a=r(57437),s=r(2265),n=r(94508);let l=s.forwardRef((e,t)=>{let{className:r,type:s,...l}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-11 w-full rounded-lg border border-input bg-white/50 px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200 hover:border-primary/50",r),ref:t,...l})});l.displayName="Input"},77992:function(e,t,r){"use strict";r.d(t,{pm:function(){return f}});var a=r(2265);let s=0,n=new Map,l=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?l(r):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=i(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=a.useState(d);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},94508:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(61994),s=r(53335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},72218:function(e,t,r){"use strict";r.d(t,{Cd:function(){return d},Dj:function(){return c},K4:function(){return l},av:function(){return f},sT:function(){return i},vJ:function(){return u}});var a=r(39129);let s={user:(e=>{try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return null}})("user"),token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken"),isAuthenticated:!!localStorage.getItem("token"),isLoading:!1,error:null},n=(0,a.oM)({name:"auth",initialState:s,reducers:{setLoading:(e,t)=>{e.isLoading=t.payload},setError:(e,t)=>{e.error=t.payload},clearError:e=>{e.error=null},logout:e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1,e.error=null,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("tokenExpiry"),localStorage.removeItem("user")},tokenRefreshed:(e,t)=>{let{token:r,refreshToken:a,expiresIn:s}=t.payload;if(e.token=r,e.refreshToken=a,e.isAuthenticated=!0,localStorage.setItem("token",r),localStorage.setItem("refreshToken",a),s){let e=Date.now()+1e3*s;localStorage.setItem("tokenExpiry",e.toString())}},setCredentials:(e,t)=>{let{user:r,token:a,refreshToken:s,expiresIn:n}=t.payload;if(e.user=r,e.token=a,e.refreshToken=s,e.isAuthenticated=!0,e.error=null,e.isLoading=!1,localStorage.setItem("token",a),localStorage.setItem("refreshToken",s),localStorage.setItem("user",JSON.stringify(r)),n){let e=Date.now()+1e3*n;localStorage.setItem("tokenExpiry",e.toString())}},setUser:(e,t)=>{e.user=t.payload,e.isAuthenticated=!0,localStorage.setItem("user",JSON.stringify(t.payload))}}}),{setLoading:l,setError:i,clearError:o,logout:d,setCredentials:c,tokenRefreshed:u,setUser:f}=n.actions;t.ZP=n.reducer},38059:function(e,t,r){"use strict";r.d(t,{h:function(){return m}});var a=r(79523),s=r(23557),n=r(72218);let l=e=>{try{return window.localStorage.getItem(e)}catch(e){return null}},i=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){}},o=e=>{try{window.localStorage.removeItem(e)}catch(e){}},d=()=>{let e=l("tokenExpiry");return!e||Date.now()>=parseInt(e,10)},c=()=>{let e=l("tokenExpiry");if(!e)return!1;let t=Date.now();return parseInt(e,10)-t<3e5},u=(0,a.ni)({baseUrl:"https://kemeteg.runasp.net/api",prepareHeaders:(e,t)=>{var r,a;let{getState:s}=t,n=(null===(a=s())||void 0===a?void 0:null===(r=a.auth)||void 0===r?void 0:r.token)||l("token");return n&&e.set("authorization","Bearer ".concat(n)),e.set("content-type","application/json"),e}}),f=async(e,t,r)=>{if(c()){console.log("Token expiring soon, refreshing proactively...");let e=l("refreshToken");if(e){let a=await u({url:"/Auth/refresh",method:"POST",body:{refreshToken:e}},t,r);if(a.data){let r=a.data,s=(null==r?void 0:r.data)||r,l=null==s?void 0:s.accessToken,o=null==s?void 0:s.refreshToken,d=(null==s?void 0:s.expiresIn)||3600;l&&(i("token",l),o&&i("refreshToken",o),i("tokenExpiry",(Date.now()+1e3*d).toString()),t.dispatch((0,n.vJ)({token:l,refreshToken:o||e,expiresIn:d})),console.log("Token refreshed successfully"))}}}let a=await u(e,t,r);if(a.error&&401===a.error.status){console.log("Unauthorized (401), attempting to refresh token...");let s=l("refreshToken");if(s&&!d()){let l=await u({url:"/Auth/refresh",method:"POST",body:{refreshToken:s}},t,r);if(l.data){let o=l.data,d=(null==o?void 0:o.data)||o,c=null==d?void 0:d.accessToken,f=null==d?void 0:d.refreshToken,m=(null==d?void 0:d.expiresIn)||3600;c&&(i("token",c),f&&i("refreshToken",f),i("tokenExpiry",(Date.now()+1e3*m).toString()),t.dispatch((0,n.vJ)({token:c,refreshToken:f||s,expiresIn:m})),a=await u(e,t,r),console.log("Token refreshed and request retried"))}else console.log("Token refresh failed, logging out..."),o("token"),o("refreshToken"),o("tokenExpiry"),t.dispatch((0,n.Cd)()),window.location.href="/login"}else console.log("No valid refresh token, logging out..."),o("token"),o("refreshToken"),o("tokenExpiry"),t.dispatch((0,n.Cd)()),window.location.href="/login"}return a},m=(0,s.LC)({reducerPath:"api",baseQuery:f,tagTypes:["User","Auth","TravelPlan","Destination","Analytics","Booking","Review","Preference","Notification"],endpoints:()=>({})})},37775:function(e,t,r){"use strict";r.d(t,{Fm:function(){return i},R5:function(){return a},aZ:function(){return l},t$:function(){return s},y0:function(){return n}});let{useGetDestinationsQuery:a,useGetDestinationQuery:s,useCreateDestinationMutation:n,useUpdateDestinationMutation:l,useDeleteDestinationMutation:i}=r(38059).h.injectEndpoints({endpoints:e=>({getDestinations:e.query({query:()=>"/Destinations",providesTags:["Destination"]}),getDestination:e.query({query:e=>"/Destinations/".concat(e),providesTags:(e,t,r)=>[{type:"Destination",id:r}]}),createDestination:e.mutation({query:e=>({url:"/Destinations",method:"POST",body:e}),invalidatesTags:["Destination"]}),updateDestination:e.mutation({query:e=>{let{id:t,data:r}=e;return{url:"/Destinations/".concat(t),method:"PUT",body:r}},invalidatesTags:(e,t,r)=>{let{id:a}=r;return[{type:"Destination",id:a},"Destination"]}}),deleteDestination:e.mutation({query:e=>({url:"/Destinations/".concat(e),method:"DELETE"}),invalidatesTags:["Destination"]})})})}},function(e){e.O(0,[6137,7210,5650,3557,3145,7489,423,2971,2117,1744],function(){return e(e.s=26259)}),_N_E=e.O()}]);